set -ex

# Set up r kernel
R -e "install.packages(c('repr', 'IRdisplay', 'evaluate', 'crayon', 'pbdZMQ', 'devtools', 'uuid', 'digest'), lib=.Library.site, repos='http://cran.us.r-project.org')"
R -e "devtools::install_github('IRkernel/IRkernel', lib=.Library.site)"

conda install nbconvert
jupyter nbconvert --to notebook --execute  --ExecutePreprocessor.timeout=60 --stdout notebooks/R.ipynb > /dev/null;

invoke build --env-name=root
invoke demofiles
invoke talk -t demo
rm -rf demofiles
rm -rf notebooks
rm -rf narrative
rm -rf slides
rm demo/notebooks/Data.ipynb
rm demo/notebooks/Julia.ipynb
jupyter lab clean
